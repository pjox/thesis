%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Towards a Cleaner Document-Oriented Annotated OSCAR Corpus}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Carbon Footprint}\label{carbon_footprint_towards}

We use a single machine having 192 GB of RAM and two Intel Xeon Gold 5218 processors, which is rated at 125 W,\footnote{\href{https://ark.intel.com/content/www/us/en/ark/products/192444/intel-xeon-gold-5218-processor-22m-cache-2-30-ghz.html}{Intel Xeon Gold 5218 specification}}. For the DRAM we can use the work of \newcite{desrochers-etal-2016-a} to estimate the total power draw of 192GB of RAM at around 20W. The total power draw of this setting adds up to around 270 W.

Having this information, we can now use the formula proposed by \newcite{strubell-etal-2019-energy} in order to compute the total power required to pre-train one model from scratch:
\[
    p_t = \frac{1.58t(cp_{c} + p_r)}{1000}
\]
Where $c$ is the number of CPUs, $p_c$ is the average power draw (in Watts) from all CPU sockets and $p_r$ the average power draw from all DRAM sockets. We estimate the total power consumption by adding CPU and DRAM consumption, and then multiplying by the \emph{Power Usage Effectiveness} (PUE), which accounts for the additional energy required to support the compute infrastructure. We use a PUE coefficient of 1.58, the 2018 global average for data centers \cite{strubell-etal-2019-energy}. The total time to generate OSCAR 22.01 in this infrastructure was of 42.6 hours. We use this information to compute the total power consumption of the OSCAR generation, which amounts to 0.4266 \unit{\kWh}.

We can further estimate the CO\textsubscript{2} emissions in kilograms of the OSCAR generation by multiplying the total power consumption by the average CO\textsubscript{2} emissions per \unit{\kWh} in our region which were 38.64\unit{\gram/\kWh} in average between the 3rd and the 5th of January 2022\footnote{\href{https://www.rte-france.com/eco2mix/les-emissions-de-co2-par-kwh-produit-en-france}{Rte - éCO\textsubscript{2}mix}.}, the exact time at which the generation was run. Thus the total CO\textsubscript{2} emissions in kg for one single model can be computed as:
\[
    \text{CO}_{2}\text{e} = 0.03864 p_t
\]
Thus total CO\textsubscript{2} emissions amount to 0.01648\unit{\kilo\gram} or 16.48\unit{\gram}.

\section{Language Table}

\begin{table}[ht!]
    \centering\tiny
    \resizebox{\linewidth}{!}{
        \begin{tabular}{lrrrclrrr}
            \toprule
            Language                    & Size      & Documents   & Words           & ~ & Language          & Size      & Documents  & Words          \\
            \midrule
            Afrikaans                   & 47.0 MB   & 12,393      & 6,227,310       & ~ & Luxembourgish     & 15.8 MB   & 5,108      & 1,545,946      \\
            Tosk Albanian               & 363.6 kB  & 139         & 37,381          & ~ & Lezghian          & 375.5 kB  & 124        & 19,250         \\
            Amharic                     & 461.0 MB  & 37,513      & 30,481,153      & ~ & Limburgish        & 1.4 kB    & 2          & 41             \\
            Aragonese                   & 10.6 kB   & 12          & 51              & ~ & Lombard           & 2.6 kB    & 2          & 225            \\
            Arabic                      & 84.2 GB   & 8,718,929   & 6,103,711,887   & ~ & Lao               & 337.1 MB  & 28,914     & 6,682,982      \\
            Egyptian Arabic             & 2.8 MB    & 1,256       & 176,096         & ~ & Lithuanian        & 20.0 GB   & 2,303,070  & 1,712,802,056  \\
            Assamese                    & 221.2 MB  & 17,084      & 11,109,557      & ~ & Latvian           & 8.2 GB    & 1,032,987  & 707,361,898    \\
            Asturian                    & 73.6 kB   & 77          & 3,919           & ~ & Maithili          & 21.6 kB   & 23         & 483            \\
            Avaric                      & 18.6 kB   & 14          & 582             & ~ & Malagasy          & 57.3 MB   & 3,028      & 7,279,056      \\
            Azerbaijani                 & 3.5 GB    & 491,847     & 291,927,692     & ~ & Eastern Mari      & 11.3 MB   & 1,612      & 641,525        \\
            South Azerbaijani           & 14.1 MB   & 5,381       & 693,746         & ~ & Minangkabau       & 6.0 MB    & 585        & 614,613        \\
            Bashkir                     & 95.5 MB   & 11,198      & 5,418,474       & ~ & Macedonian        & 3.6 GB    & 341,775    & 244,058,579    \\
            Belarusian                  & 1.8 GB    & 180,046     & 107,227,860     & ~ & Malayalam         & 4.1 GB    & 250,972    & 137,831,247    \\
            Bulgarian                   & 35.1 GB   & 2,887,115   & 2,405,981,285   & ~ & Mongolian         & 2.8 GB    & 237,719    & 176,405,432    \\
            Bihari languages            & 24.2 kB   & 27          & 569             & ~ & Marathi           & 3.3 GB    & 250,376    & 160,179,233    \\
            Bangla                      & 15.1 GB   & 1,171,501   & 751,877,226     & ~ & Western Mari      & 743.5 kB  & 155        & 43,916         \\
            Tibetan                     & 234.5 MB  & 18,683      & 2,286,269       & ~ & Malay             & 5.3 MB    & 5,228      & 217,818        \\
            Bishnupriya                 & 2.0 MB    & 271         & 98,419          & ~ & Maltese           & 2.5 MB    & 2,208      & 118,190        \\
            Breton                      & 33.7 MB   & 16,119      & 3,111,619       & ~ & Multilingual      & 12.1 GB   & 1,210,685  & 936,187,711    \\
            Bosnian                     & 10.3 kB   & 10          & 422             & ~ & Burmese           & 1.9 GB    & 158,733    & 44,835,970     \\
            Russia Buriat               & 32.9 kB   & 39          & 785             & ~ & Mazanderani       & 128.2 kB  & 76         & 7,337          \\
            Catalan                     & 13.9 GB   & 2,627,307   & 1,508,919,864   & ~ & Nahuatl languages & 8.7 kB    & 12         & 179            \\
            Chechen                     & 14.0 MB   & 4,086       & 798,766         & ~ & Low German        & 9.0 MB    & 1,938      & 1,012,561      \\
            Cebuano                     & 44.6 MB   & 5,742       & 5,253,785       & ~ & Nepali            & 3.7 GB    & 391,947    & 177,885,116    \\
            Central Kurdish             & 716.4 MB  & 84,950      & 43,913,025      & ~ & Newari            & 5.7 MB    & 1,134      & 273,837        \\
            Czech                       & 58.6 GB   & 10,381,916  & 5,452,724,456   & ~ & Dutch             & 114.0 GB  & 20,206,532 & 12,329,127,151 \\
            Chuvash                     & 41.8 MB   & 4,750       & 2,465,782       & ~ & Norwegian Nynorsk & 6.8 MB    & 5,835      & 459,183        \\
            Welsh                       & 409.3 MB  & 90,378      & 49,488,495      & ~ & Norwegian         & 2.8 GB    & 973,188    & 279,182,902    \\
            Danish                      & 12.6 GB   & 2,265,479   & 1,454,439,292   & ~ & Occitan           & 2.1 MB    & 373        & 31,061         \\
            German                      & 496.7 GB  & 70,075,424  & 46,826,676,844  & ~ & Odia              & 487.9 MB  & 52,942     & 23,755,902     \\
            Dimli (individual language) & 706 Bytes & 1           & 19              & ~ & Ossetic           & 13.9 MB   & 3,560      & 800,430        \\
            Lower Sorbian               & 707 Bytes & 1           & 17              & ~ & Punjabi           & 1.1 GB    & 68,094     & 70,068,604     \\
            Divehi                      & 217.2 MB  & 24,067      & 10,112,205      & ~ & Polish            & 139.0 GB  & 19,301,137 & 12,584,498,906 \\
            Greek                       & 78.3 GB   & 6,738,546   & 5,031,242,803   & ~ & Piedmontese       & 1.7 MB    & 698        & 188,270        \\
            Emiliano-Romagnolo.         & 901 Bytes & 1           & 53              & ~ & Western Panjabi   & 46.7 MB   & 6,790      & 4,060,419      \\
            English                     & 3.2 TB    & 431,992,659 & 377,376,402,775 & ~ & Pashto            & 490.3 MB  & 50,312     & 46,293,249     \\
            Esperanto                   & 558.3 MB  & 111,932     & 58,416,628      & ~ & Portuguese        & 170.3 GB  & 23,735,707 & 18,441,864,893 \\
            Spanish                     & 381.9 GB  & 51,386,247  & 42,829,835,316  & ~ & Quechua           & 744 Bytes & 1          & 14             \\
            Estonian                    & 9.2 GB    & 1,362,524   & 820,975,443     & ~ & Romanian          & 49.2 GB   & 4,624,764  & 5,261,803,995  \\
            Basque                      & 1.1 GB    & 233,658     & 97,092,942      & ~ & Russian           & 1.1 TB    & 76,060,844 & 62,811,122,663 \\
            Persian                     & 77.4 GB   & 7,665,871   & 6,430,164,396   & ~ & Sanskrit          & 136.0 MB  & 4,472      & 5,671,369      \\
            Finnish                     & 37.8 GB   & 4,948,961   & 2,900,615,928   & ~ & Sakha             & 65.6 MB   & 6,284      & 3,473,813      \\
            French                      & 382.2 GB  & 52,037,098  & 41,713,990,658  & ~ & Sicilian          & 1.5 kB    & 2          & 50             \\
            Western Frisian             & 75.3 MB   & 21,946      & 6,357,929       & ~ & Sindhi            & 117.1 MB  & 15,516     & 10,685,611     \\
            Irish                       & 45.6 MB   & 12,233      & 4,877,850       & ~ & Serbian (Latin)   & 931.8 kB  & 738        & 92,875         \\
            Scottish Gaelic             & 137.7 kB  & 136         & 7,769           & ~ & Sinhala           & 2.0 GB    & 108,593    & 113,179,741    \\
            Galician                    & 255.2 MB  & 88,803      & 27,051,212      & ~ & Slovak            & 16.5 GB   & 2,409,555  & 1,619,121,944  \\
            Guarani                     & 9.0 kB    & 10          & 374             & ~ & Slovenian         & 1.2 GB    & 351,894    & 118,400,246    \\
            Goan Konkani                & 787.2 kB  & 46          & 38,831          & ~ & Somali            & 2.1 kB    & 3          & 109            \\
            Gujarati                    & 4.8 GB    & 136,467     & 301,170,777     & ~ & Albanian          & 3.0 GB    & 437,287    & 326,325,149    \\
            Hebrew                      & 30.3 GB   & 3,132,396   & 2,249,377,984   & ~ & Serbian           & 6.9 GB    & 577,472    & 482,932,670    \\
            Hindi                       & 23.3 GB   & 1,529,907   & 1,534,799,198   & ~ & Sundanese         & 5.0 MB    & 263        & 547,145        \\
            Croatian                    & 11.2 MB   & 11,462      & 505,369         & ~ & Swedish           & 48.0 GB   & 7,541,278  & 5,078,331,128  \\
            Upper Sorbian               & 132.8 kB  & 110         & 8,825           & ~ & Swahili           & 1.3 MB    & 462        & 123,050        \\
            Hungarian                   & 53.9 GB   & 6,866,062   & 4,598,787,907   & ~ & Tamil             & 11.4 GB   & 556,772    & 452,343,748    \\
            Armenian                    & 4.7 GB    & 379,267     & 268,031,270     & ~ & Telugu            & 3.4 GB    & 249,756    & 137,752,065    \\
            Interlingua                 & 40.2 kB   & 6           & 10,125          & ~ & Tajik             & 870.9 MB  & 46,366     & 56,627,727     \\
            Indonesian                  & 17.4 GB   & 2,244,622   & 1,984,195,207   & ~ & Thai              & 66.1 GB   & 5,030,254  & 1,626,779,846  \\
            Iloko                       & 97.9 kB   & 75          & 8,592           & ~ & Turkmen           & 4.4 MB    & 2,485      & 276,632        \\
            Ido                         & 77.3 kB   & 105         & 2,690           & ~ & Filipino          & 646.5 MB  & 70,394     & 81,881,278     \\
            Icelandic                   & 2.0 GB    & 396,183     & 210,365,124     & ~ & Turkish           & 75.1 GB   & 10,826,031 & 6,421,221,358  \\
            Italian                     & 229.3 GB  & 28,502,092  & 24,294,684,830  & ~ & Tatar             & 915.3 MB  & 76,398     & 51,875,265     \\
            Japanese                    & 258.7 GB  & 36,328,931  & 5,592,948,356   & ~ & Uyghur            & 201.9 MB  & 18,556     & 11,240,889     \\
            Lojban                      & 1.9 MB    & 570         & 260,542         & ~ & Ukrainian         & 48.8 GB   & 4,558,214  & 2,879,585,992  \\
            Javanese                    & 152.7 kB  & 70          & 10,441          & ~ & Urdu              & 3.4 GB    & 336,994    & 332,816,354    \\
            Georgian                    & 7.1 GB    & 488,588     & 281,430,479     & ~ & Uzbek             & 19.9 MB   & 9,526      & 1,370,842      \\
            Kazakh                      & 2.9 GB    & 261,085     & 157,267,307     & ~ & Vietnamese        & 98.9 GB   & 9,587,233  & 12,283,185,482 \\
            Khmer                       & 1.9 GB    & 121,910     & 30,564,131      & ~ & Volapük           & 825.9 kB  & 661        & 57,039         \\
            Kannada                     & 2.6 GB    & 150,850     & 108,450,571     & ~ & Walloon           & 105.7 kB  & 138        & 4,386          \\
            Korean                      & 51.8 GB   & 5,881,481   & 3,854,968,649   & ~ & Waray             & 7.6 MB    & 933        & 830,872        \\
            Karachay-Balkar             & 119.6 kB  & 91          & 4,089           & ~ & Wu Chinese        & 137.2 kB  & 88         & 3,056          \\
            Kurdish                     & 150.3 MB  & 29,906      & 17,390,759      & ~ & Kalmyk            & 9.3 kB    & 9          & 250            \\
            Komi                        & 119.9 kB  & 127         & 3,335           & ~ & Mingrelian        & 7.6 MB    & 2,550      & 253,333        \\
            Cornish                     & 1.4 kB    & 2           & 55              & ~ & Yiddish           & 232.5 MB  & 23,418     & 15,809,780     \\
            Kyrgyz                      & 518.6 MB  & 62,244      & 28,028,986      & ~ & Yoruba            & 24.7 kB   & 26         & 1,042          \\
            Latin                       & 4.1 MB    & 4,397       & 187,446         & ~ & Chinese           & 900.9 GB  & 56,524,518 & 23,149,203,886 \\
            \bottomrule
        \end{tabular}
    }
    \caption{Size of the OSCAR 22.01 corpus by language measured in bytes and number of words. Standard UNIX human-readable notation is used for the size in byte. We define ``words'' as spaced separated tokens, which gives a good estimate of the size of each corpus for languages using Latin or Cyrillic alphabets, but might give a misleading size for other languages such as Chinese or Japanese.}
    \label{tab:langs_towards}
\end{table}